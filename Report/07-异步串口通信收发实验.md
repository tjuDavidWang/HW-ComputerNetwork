# 异步串口通信收发实验

2023/09/25

## 实验目的

本实验旨在深入了解串口与并口的工作原理和应用场景，掌握其在数据传输中的优缺点。

## 实验原理 

- ##### 串口（Serial Port）

  - 物理连接: 串口在PC系统中有9针和25针两种物理连接方式。目前主流是9针连接方式，直接集成在主板上。一般的PC主板都提供两个串口——COM1和COM2。
  - 通信协议: 串口通常使用**RS232**接口作为通信协议，该协议由美国电子工业协会（EIA）于1970年制定。
  - 信号电平: RS232采用负逻辑电平，其中-15V到-3V表示逻辑1，+15V到+3V表示逻辑0。
  - 数据传输速度: 标准的串口能够达到最高115Kbps的数据传输速度，而增强型串口如ESP和Super ESP则能达到460Kbps。

- **并口（Parallel Port）**

  - 物理连接: 并口通常使用25针的连接方式，也被称为LPT接口。

  - 通信协议: 并口使用并行通信协议，允许多个数据位同时传输。

  - 数据传输速度: 标准并口的数据传输率为1Mbps，通常用于连接打印机、扫描仪等。

- **串口与并口的比较**

  |      | 数据传输方式                                             | 传输距离                                     |
  | ---- | -------------------------------------------------------- | -------------------------------------------- |
  | 串口 | 一种串行传输方式，即一次只能传输一个数据位               | 一种并行传输方式，即一次可以传输多个数据位   |
  | 并口 | 由于其电平特性和信号处理方式，它常用于更长距离的数据传输 | 由于多线并行特性，通常用于短距离高速数据传输 |

## 实验设备 

- 装有Windows7操作系统的PC两台
- DB9串口线一条

## 实验步骤

1. **准备阶段**
   1. 硬件准备: 确保两台PC主机都具备COM1串口，并准备一根DB9串口线。
   2. 软件准备: 在两台PC主机上分别安装串口调试软件。本实验使用的是友善串口调试助手与XCOM V2.0。

2. **连接阶段**

​		建立连接: 使用DB9串口线将两台PC主机的COM1口连接起来。

3. **配置阶段**
   1. 打开软件: 分别打开两台电脑上的串口调试软件。
   2. 选择模式: 在串口调试软件的界面中，选择“串口模式（Serial）”。
   3. 参数设置: 在软件中进行以下参数设置：
      - 选择COM1作为操作的串口。
      - 设置每秒位数（Baud Rate），如9600或115200。
      - 设置数据位（Data Bits），如8位。
      - 设置奇偶校验（Parity），如None。
      - 设置停止位（Stop Bits），如1位。

4. **数据传输阶段**
   1. 开始传输: 在两台主机上分别通过串口进行数据传输。确保发送和接收都成功。
   2. 观测结果: 记录数据传输的速度、延迟和任何可能的错误。

5. **实验变量调整阶段**
   1. 参数调整: 改变串口参数（如每秒位数、数据位等），重新进行数据传输。
   2. 观测变化: 记录改变参数后的数据传输速度、延迟和效率。

## 实验现象

1. 当两台电脑的数据位设置为8位、奇偶校验设置一致（无论是奇校验、偶校验或无校验），以及停止位设置相同时，串口通信成功。这是因为数据位的一致性确保了双方能准确地解码对方发送的字符或命令；奇偶校验的一致性使得双方能同步地进行错误检测和纠正；而停止位的一致性则确保了双方能准确地识别字符或命令的结束，从而实现有效的数据传输。（如下图两台主机可以正常通信）![image-20230927182438999](C:\Users\12920\AppData\Roaming\Typora\typora-user-images\image-20230927182438999.png)

2. 当上述三个条件中有任何一个不一致时，串口通信失败。这是因为数据位的不匹配会导致接收端无法准确解码发送端的字符或命令，从而产生数据传输错误；奇偶校验的不一致会导致两台电脑无法同步进行错误检测和纠正，可能产生数据错误；而停止位的不匹配则会导致两台电脑无法准确识别字符或命令的结束，从而导致数据传输中断或错误。（如下图使用了不同的校验码发出第一个odd，在右边不能接收到信号）

   ![image-20230927182722109](C:\Users\12920\AppData\Roaming\Typora\typora-user-images\image-20230927182722109.png)


## 分析讨论 

1. **两台主机使用不同软件却可以通信**

   这可以从开放系统互联（OSI）模型的角度进行解释。在OSI模型中，应用层负责处理特定应用程序的细节，而物理层则负责底层的数据传输。在这里，不同的串口调试软件操作在应用层，而RS232协议则作为物理层的通信标准。由于RS232协议规定了数据传输的基础参数和电平标准，这确保了不同应用层软件下的主机能够在物理层实现一致和准确的数据交换，从而成功地进行通信。